<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: 静态代码扫描 | Blues 小站]]></title>
  <link href="http://www.shenyanchao.cn/tags/静态代码扫描/atom.xml" rel="self"/>
  <link href="http://www.shenyanchao.cn/"/>
  <updated>2014-09-02T18:41:46+08:00</updated>
  <id>http://www.shenyanchao.cn/</id>
  <author>
    <name><![CDATA[ShenYanchao]]></name>
    <email><![CDATA[zhiyi.shen@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Maven项目集成CheckStyle,PMD,FindBugs进行静态代码扫描]]></title>
    <link href="http://www.shenyanchao.cn/blog/2013/11/20/maven-project-integrate-checkstyle-pmd-findbugs/"/>
    <updated>2013-11-20T19:22:00+08:00</updated>
    <id>http://www.shenyanchao.cn/blog/2013/11/20/maven-project-integrate-checkstyle-pmd-findbugs</id>
    <content type="html"><![CDATA[<p>在pom.xml里添加以下maven插件配置：</p>

<pre><code>    &lt;!-- 静态代码检查 --&gt;
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-checkstyle-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.11&lt;/version&gt;
    &lt;configuration&gt;
        &lt;configLocation&gt;checkstyle.xml&lt;/configLocation&gt;
        &lt;includeResources&gt;false&lt;/includeResources&gt;
        &lt;failOnViolation&gt;true&lt;/failOnViolation&gt;
        &lt;violationSeverity&gt;info&lt;/violationSeverity&gt;
        &lt;maxAllowedViolations&gt;0&lt;/maxAllowedViolations&gt;
        &lt;consoleOutput&gt;true&lt;/consoleOutput&gt;
        &lt;encoding&gt;UTF-8&lt;/encoding&gt;
        &lt;includes&gt;
            **\/package\/**.java,**\/otherpackage\/**.java
        &lt;/includes&gt;
    &lt;/configuration&gt;
&lt;!--     &lt;executions&gt;
         &lt;execution&gt;
             &lt;goals&gt;
                 &lt;goal&gt;check&lt;/goal&gt;
             &lt;/goals&gt;
             &lt;phase&gt;validate&lt;/phase&gt;
         &lt;/execution&gt;
     &lt;/executions&gt;--&gt;
&lt;/plugin&gt;

&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.7.1&lt;/version&gt;
    &lt;configuration&gt;
        &lt;failurePriority&gt;5&lt;/failurePriority&gt;
        &lt;failOnViolation&gt;true&lt;/failOnViolation&gt;
        &lt;targetJdk&gt;${jdk.version}&lt;/targetJdk&gt;
        &lt;verbose&gt;true&lt;/verbose&gt;
        &lt;outputEncoding&gt;UTF-8&lt;/outputEncoding&gt;
        &lt;rulesets&gt;
            &lt;ruleset&gt;pmd.xml&lt;/ruleset&gt;
        &lt;/rulesets&gt;
        &lt;includes&gt;
            &lt;include&gt;**\/package\/**.java&lt;/include&gt;
            &lt;include&gt;**\/otherpackage\/**.java&lt;/include&gt;
        &lt;/includes&gt;
    &lt;/configuration&gt;
  &lt;!--   &lt;executions&gt;
         &lt;execution&gt;
             &lt;phase&gt;package&lt;/phase&gt;
             &lt;goals&gt;
                 &lt;goal&gt;check&lt;/goal&gt;
             &lt;/goals&gt;
         &lt;/execution&gt;
     &lt;/executions&gt;--&gt;
&lt;/plugin&gt;
&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;findbugs-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.5.2&lt;/version&gt;
    &lt;configuration&gt;
        &lt;onlyAnalyze&gt;
            cn.shenyanchao.package.*,
            cn.shenyanchao.otherpackage.*,
        &lt;/onlyAnalyze&gt;
        &lt;includeFilterFile&gt;findbugs.xml&lt;/includeFilterFile&gt;
        &lt;failOnError&gt;true&lt;/failOnError&gt;
        &lt;outputEncoding&gt;UTF-8&lt;/outputEncoding&gt;
    &lt;/configuration&gt;
 &lt;!--   &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;check&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;--&gt;
&lt;/plugin&gt;
</code></pre>

<p>这些配置集成了checkstyle,pmd,findbugs的插件。并指明了要使用的规则集合（checkstyle.xml,pmd.xml,findbugs.xml）。</p>

<!--more-->


<p></p>

<h5>那么能否指定只扫描特定的包或者文件呢？</h5>

<p>上面checkstyle用的是：</p>

<pre><code>&lt;includes&gt;
    **\/package\/**.java,**\/otherpackage\/**.java
&lt;/includes&gt;
</code></pre>

<p>pmd是：</p>

<pre><code>&lt;includes&gt;
    &lt;include&gt;**\/package\/**.java&lt;/include&gt;
    &lt;include&gt;**\/otherpackage\/**.java&lt;/include&gt;
&lt;/includes&gt;
</code></pre>

<p>findbugs则使用的是：</p>

<pre><code>&lt;onlyAnalyze&gt;
    cn.shenyanchao.package.*,
    cn.shenyanchao.otherpackage.*,
&lt;/onlyAnalyze&gt;
</code></pre>

<h5>如何在编译期间或打包期间执行检查？</h5>

<p>如上所示的注释掉部分，添加就可以了：</p>

<pre><code>&lt;executions&gt;
     &lt;execution&gt;
         &lt;phase&gt;package&lt;/phase&gt;
         &lt;goals&gt;
             &lt;goal&gt;check&lt;/goal&gt;
         &lt;/goals&gt;
     &lt;/execution&gt;
 &lt;/executions&gt;
</code></pre>

<p>这里的意思是在mvn 执行打包package的时候进行check操作。因此如果check不通过，那么将不会编译打包成功。</p>
]]></content>
  </entry>
  
</feed>